# JuFireX 架构图表源文件

## 1. 整体架构拓扑图

```mermaid
graph TB
    subgraph "客户端层 (Client Layer)"
        Browser[浏览器 Browser]
        Mobile[移动端 Mobile]
    end
    
    subgraph "前端层 (Frontend Layer)"
        subgraph "Vue.js 应用"
            Router[Vue Router<br/>路由管理]
            Store[Pinia Store<br/>状态管理]
            Components[Vue Components<br/>组件系统]
            API[API Layer<br/>接口层]
        end
        
        subgraph "构建工具"
            Vite[Vite 6.3.6<br/>构建工具]
            TS[TypeScript 5.4.5<br/>类型系统]
        end
        
        subgraph "UI框架"
            NaiveUI[Naive UI 2.43.1<br/>组件库]
            Bootstrap[Bootstrap 5.3.8<br/>样式框架]
            FontAwesome[Font Awesome 7.1.0<br/>图标库]
        end
    end
    
    subgraph "网络层 (Network Layer)"
        Proxy[Vite Proxy<br/>开发代理]
        HTTP[HTTP/HTTPS<br/>通信协议]
    end
    
    subgraph "后端层 (Backend Layer)"
        subgraph "Flask 应用"
            Routes[API Routes<br/>路由层]
            Services[Service Layer<br/>业务逻辑层]
            Models[Model Layer<br/>数据模型层]
            Utils[Utils Layer<br/>工具层]
        end
        
        subgraph "中间件"
            CORS[Flask-CORS<br/>跨域处理]
            Auth[认证中间件<br/>JWT/Session]
        end
    end
    
    subgraph "数据层 (Data Layer)"
        SQLite[(SQLite Database<br/>本地数据库)]
        MockData[Mock Data<br/>模拟数据]
    end
    
    subgraph "部署层 (Deployment Layer)"
        DevServer[开发服务器<br/>Flask Dev Server]
        StaticFiles[静态文件服务<br/>Vite Dev Server]
    end

    Browser --> Router
    Mobile --> Router
    Router --> Store
    Router --> Components
    Components --> API
    API --> HTTP
    HTTP --> Proxy
    Proxy --> Routes
    Routes --> Services
    Services --> Models
    Models --> SQLite
    Services --> MockData
    
    Components --> NaiveUI
    Components --> Bootstrap
    Components --> FontAwesome
    
    Vite --> TS
    Vite --> StaticFiles
    DevServer --> Routes
```

## 2. 服务层依赖关系图

```mermaid
graph TB
    API[API Layer] --> Service[Service Layer]
    Service --> Model[Model Layer]
    Service --> Utils[Utils Layer]
    Service --> Exception[Exception Handler]
    
    subgraph "Service Layer"
        AuthService[AuthService<br/>认证服务]
        UserService[UserService<br/>用户服务]
    end
    
    AuthService --> UserService
```

## 3. 前端状态管理依赖图

```mermaid
graph LR
    UserStore --> API[API Layer]
    UserStore --> Router[Vue Router]
    Components --> UserStore
    API --> HTTP[Axios HTTP Client]
```

## 4. 用户认证流程时序图

```mermaid
sequenceDiagram
    participant U as 用户
    participant F as 前端应用
    participant A as API网关
    participant AS as 认证服务
    participant US as 用户服务
    participant DB as 数据库

    U->>F: 输入用户名密码
    F->>F: 表单验证
    F->>A: POST /api/auth/login
    A->>AS: 调用登录服务
    AS->>US: 验证用户凭据
    US->>DB: 查询用户信息
    DB-->>US: 返回用户数据
    US-->>AS: 返回验证结果
    AS->>AS: 生成会话令牌
    AS-->>A: 返回登录结果
    A-->>F: 返回响应(含Token)
    F->>F: 更新用户状态
    F-->>U: 显示登录成功
```

## 5. 用户信息获取流程时序图

```mermaid
sequenceDiagram
    participant F as 前端应用
    participant A as API网关
    participant AS as 认证服务
    participant US as 用户服务

    F->>A: GET /api/user/info<br/>(携带Authorization Header)
    A->>AS: 验证会话令牌
    AS->>AS: 检查令牌有效性
    alt 令牌有效
        AS->>US: 获取用户详细信息
        US-->>AS: 返回用户信息
        AS-->>A: 返回认证用户信息
        A-->>F: 返回用户详细信息
    else 令牌无效
        AS-->>A: 返回401未授权
        A-->>F: 返回认证失败
        F->>F: 清除本地状态
        F->>F: 重定向到登录页
    end
```

## 6. 异常处理流程图

```mermaid
graph TD
    Request[API请求] --> Validate[参数验证]
    Validate -->|验证失败| BadRequest[400 Bad Request]
    Validate -->|验证成功| Auth[身份认证]
    Auth -->|认证失败| Unauthorized[401 Unauthorized]
    Auth -->|认证成功| Permission[权限检查]
    Permission -->|权限不足| Forbidden[403 Forbidden]
    Permission -->|权限通过| Business[业务逻辑处理]
    Business -->|业务异常| BusinessError[业务错误响应]
    Business -->|处理成功| Success[200 Success]
    Business -->|系统异常| ServerError[500 Internal Server Error]
```

## 7. 技术演进路线图 - 阶段一

```mermaid
gantt
    title 技术演进路线图 - 阶段一
    dateFormat  YYYY-MM-DD
    section 数据层
    数据库模型实现    :active, db1, 2025-01-15, 2025-02-15
    数据迁移脚本      :db2, after db1, 15d
    section 认证系统
    JWT完整实现       :auth1, 2025-01-20, 2025-02-20
    权限管理系统      :auth2, after auth1, 10d
    section 测试体系
    单元测试编写      :test1, 2025-02-01, 2025-02-28
    集成测试实现      :test2, after test1, 15d
```

## 8. 技术演进路线图 - 阶段二

```mermaid
gantt
    title 技术演进路线图 - 阶段二
    dateFormat  YYYY-MM-DD
    section 缓存系统
    Redis集成         :cache1, 2025-04-01, 2025-04-30
    缓存策略优化      :cache2, after cache1, 15d
    section 前端优化
    代码分割优化      :fe1, 2025-04-15, 2025-05-15
    PWA功能实现       :fe2, after fe1, 20d
    section 监控系统
    日志系统集成      :monitor1, 2025-05-01, 2025-05-30
    性能监控实现      :monitor2, after monitor1, 15d
```

## 9. 技术演进路线图 - 阶段三

```mermaid
gantt
    title 技术演进路线图 - 阶段三
    dateFormat  YYYY-MM-DD
    section 微服务化
    服务拆分设计      :micro1, 2025-07-01, 2025-07-31
    API网关实现       :micro2, after micro1, 30d
    section 云原生
    Docker容器化      :cloud1, 2025-08-01, 2025-08-31
    Kubernetes部署    :cloud2, after cloud1, 30d
    section 实时功能
    WebSocket集成     :realtime1, 2025-09-01, 2025-09-30
    消息队列实现      :realtime2, after realtime1, 30d
```

## 10. 数据模型关系图

```mermaid
erDiagram
    User {
        int id PK
        string username UK
        string nickname
        string email UK
        string password
        string avatar
        int permission
        boolean is_active
        boolean is_verified
        datetime created_at
        datetime updated_at
        datetime last_login_at
    }
    
    Session {
        string token PK
        int user_id FK
        datetime created_at
        datetime expires_at
        boolean is_active
        datetime logout_at
    }
    
    User ||--o{ Session : "has many"
```

## 11. API路由结构图

```mermaid
graph LR
    API["/api"]
    
    API --> Auth["/auth"]
    API --> User["/user"] 
    API --> Hello["/hello"]
    
    Auth --> AuthRoutes["认证路由"]
    User --> UserRoutes["用户路由"]
    Hello --> HelloRoutes["Hello路由"]
    
    AuthRoutes --> Register["POST /register<br/>用户注册"]
    AuthRoutes --> Login["POST /login<br/>用户登录"]
    AuthRoutes --> Logout["POST /logout<br/>用户登出"]
    AuthRoutes --> Status["GET /status<br/>认证状态"]
    AuthRoutes --> Refresh["POST /refresh<br/>刷新令牌"]
    AuthRoutes --> Validate["POST /validate<br/>验证令牌"]
    
    UserRoutes --> UserInfo["GET /info<br/>获取用户信息"]
    UserRoutes --> UserById["GET /{id}<br/>根据ID获取用户"]
    UserRoutes --> UserSession["GET /session<br/>获取会话信息"]
    UserRoutes --> UpdateProfile["PUT /profile<br/>更新用户资料"]
    UserRoutes --> UserList["GET /list<br/>获取用户列表"]
    
    HelloRoutes --> HelloMsg["GET /<br/>Hello消息"]
```

## 12. 前端组件层次结构图

```mermaid
graph LR
    App[App.vue<br/>根组件]
    
    App --> CoreComponents[核心组件]
    App --> PageComponents[页面组件]
    App --> FeatureComponents[功能组件]
    
    CoreComponents --> Router[RouterView<br/>路由视图]
    CoreComponents --> LoadingScreen[LoadingScreen.vue<br/>加载屏幕]
    CoreComponents --> Header[Header Component<br/>头部组件]
    CoreComponents --> Footer[Footer Component<br/>底部组件]
    
    PageComponents --> MainPages[主要页面]
    PageComponents --> AdminPages[管理页面]
    PageComponents --> SettingPages[设置页面]
    
    MainPages --> Home[Home.vue<br/>首页]
    MainPages --> Login[Login.vue<br/>登录页]
    MainPages --> Register[Register.vue<br/>注册页]
    MainPages --> Profile[Profile.vue<br/>个人资料]
    MainPages --> Navigation[Navigation.vue<br/>导航页]
    MainPages --> Project[Project.vue<br/>项目页]
    MainPages --> Contact[Contact.vue<br/>联系页]
    MainPages --> Hello[Hello.vue<br/>Hello页]
    
    AdminPages --> AdminUser[admin/User.vue<br/>用户管理]
    AdminPages --> AdminProject[admin/Project.vue<br/>项目管理]
    AdminPages --> AdminNavigation[admin/Navigation.vue<br/>导航管理]
    
    SettingPages --> SettingAccount[setting/Account.vue<br/>账户设置]
    SettingPages --> SettingPreference[setting/Preference.vue<br/>偏好设置]
    SettingPages --> SettingStudio[setting/Studio.vue<br/>工作室设置]
    
    FeatureComponents --> ToggleTag[ToggleTag.vue<br/>切换标签组件]
    
    Header --> ToggleTag
```